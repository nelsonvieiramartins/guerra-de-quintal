<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Guerra de Quintal: Mestres da Sucata</title>
    <style>
        /* ===== RESET & BASE ===== */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Georgia', 'Times New Roman', serif;
            background: linear-gradient(135deg, #f4e4bc 0%, #e8d5b5 50%, #dcc9a5 100%);
            min-height: 100vh; color: #3d2817; overflow-x: hidden;
        }
        .paper-texture {
            position: fixed; top: 0; left: 0; right: 0; bottom: 0;
            background-image: repeating-linear-gradient(0deg, transparent, transparent 2px, rgba(139, 69, 19, 0.02) 2px, rgba(139, 69, 19, 0.02) 4px);
            pointer-events: none; z-index: 1000;
        }

        /* ===== HEADER ===== */
        .header {
            background: linear-gradient(180deg, #8b4513 0%, #5c3310 100%);
            padding: 15px 20px; text-align: center;
            border-bottom: 5px solid #cd853f;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
        }
        .header h1 { color: #f4e4bc; font-size: 2em; text-shadow: 3px 3px 0 #3d2817; letter-spacing: 2px; }
        .header .subtitle { color: #d4a574; font-style: italic; font-size: 1em; margin-top: 5px; }

        /* ===== NAVIGATION ===== */
        .nav { display: flex; justify-content: center; gap: 10px; padding: 15px; flex-wrap: wrap; background: rgba(139, 69, 19, 0.1); }
        .nav-btn {
            background: linear-gradient(180deg, #cd853f 0%, #8b4513 100%);
            border: 3px solid #5c3310; color: #f4e4bc;
            padding: 12px 25px; font-size: 1em; font-family: 'Georgia', serif;
            font-weight: bold; cursor: pointer; border-radius: 10px;
            transition: all 0.3s ease; box-shadow: 3px 3px 0 rgba(0,0,0,0.3);
        }
        .nav-btn:hover { transform: translateY(-3px); box-shadow: 5px 5px 0 rgba(0,0,0,0.3); }
        .nav-btn.active { background: linear-gradient(180deg, #d4a574 0%, #a0522d 100%); border-color: #cd853f; transform: scale(1.05); }

        /* ===== MAIN CONTENT ===== */
        .main { max-width: 1200px; margin: 0 auto; padding: 15px; }
        .section { display: none; animation: fadeIn 0.5s ease; }
        .section.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

        /* ===== CARDS ===== */
        .card {
            background: linear-gradient(135deg, #f9edd3 0%, #f4e4bc 50%, #e8d5b5 100%);
            border: 3px solid #8b4513; border-radius: 15px;
            padding: 15px; margin: 10px 0;
            box-shadow: 5px 5px 0 rgba(139, 69, 19, 0.3);
            position: relative;
        }
        .card-title {
            font-size: 1.3em; color: #8b4513; text-align: center;
            margin-bottom: 10px; text-shadow: 1px 1px 0 rgba(255,255,255,0.5);
            border-bottom: 2px dashed #c9a66b; padding-bottom: 8px;
        }

        /* ===== CRAFT CARD ===== */
        .craft-card {
            background: linear-gradient(180deg, #fff 0%, #f5f0e1 100%);
            border: 3px solid #cd853f; border-radius: 12px;
            padding: 8px; text-align: center; cursor: pointer;
            transition: all 0.3s ease; box-shadow: 2px 2px 5px rgba(0,0,0,0.2);
            min-width: 90px;
        }
        .craft-card:hover { transform: translateY(-5px); box-shadow: 5px 5px 15px rgba(0,0,0,0.3); border-color: #22c55e; }
        .craft-card.selected { border-color: #22c55e; box-shadow: 0 0 20px rgba(34, 197, 94, 0.5); transform: scale(1.05); }
        .craft-card.disabled { opacity: 0.4; cursor: not-allowed; }
        .craft-card .card-image { width: 100%; height: 60px; object-fit: cover; border-radius: 8px; margin-bottom: 5px; background: #e8d5b5; }
        .craft-card .card-emoji { font-size: 2em; margin: 5px 0; }
        .craft-card .card-name { font-size: 0.75em; color: #5c3310; font-weight: bold; line-height: 1.2; }
        .craft-card .card-type { font-size: 0.65em; color: #8b4513; margin-top: 2px; }

        /* ===== CRAFTING SLOTS ===== */
        .crafting-area {
            display: flex; justify-content: center; align-items: center;
            gap: 10px; flex-wrap: wrap; padding: 20px;
            background: linear-gradient(180deg, rgba(139, 69, 19, 0.1) 0%, rgba(139, 69, 19, 0.05) 100%);
            border-radius: 15px; margin: 10px 0;
        }
        .craft-slot {
            width: 100px; height: 140px;
            border: 3px dashed #8b4513; border-radius: 12px;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            background: rgba(255,255,255,0.5);
            transition: all 0.3s ease; cursor: pointer; position: relative;
        }
        .craft-slot:hover { border-style: solid; background: rgba(255,255,255,0.8); transform: scale(1.05); }
        .craft-slot.filled { border-style: solid; border-color: #22c55e; background: linear-gradient(180deg, #dcfce7 0%, #bbf7d0 100%); }
        .craft-slot .slot-image { width: 90%; height: 60px; object-fit: cover; border-radius: 8px; margin-bottom: 5px; }
        .craft-slot .slot-emoji { font-size: 2em; }
        .craft-slot .slot-label { font-size: 0.65em; color: #5c3310; margin-top: 3px; text-align: center; font-weight: bold; padding: 0 3px; }
        .craft-slot .slot-type { font-size: 0.55em; color: #8b4513; position: absolute; bottom: 3px; }

        .plus-sign, .equals-sign { font-size: 1.8em; color: #8b4513; font-weight: bold; }
        .result-slot {
            width: 120px; height: 160px;
            border: 4px solid #cd853f; border-radius: 15px;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            background: linear-gradient(180deg, #f9edd3 0%, #f4e4bc 100%);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        .result-slot.filled { border-color: #22c55e; background: linear-gradient(180deg, #dcfce7 0%, #bbf7d0 100%); animation: resultPulse 1s ease; }
        @keyframes resultPulse { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.05); } }

        /* ===== WEAPON RESULT ===== */
        .weapon-result {
            background: linear-gradient(135deg, #2c1810 0%, #3d2817 50%, #2c1810 100%);
            border: 4px solid #cd853f; border-radius: 15px;
            padding: 12px; color: #f4e4bc; text-align: center;
            box-shadow: 0 5px 20px rgba(0,0,0,0.4);
            animation: weaponAppear 0.5s ease;
        }
        @keyframes weaponAppear { from { transform: scale(0) rotate(-10deg); opacity: 0; } to { transform: scale(1) rotate(0deg); opacity: 1; } }
        .weapon-result .weapon-image { width: 100%; max-width: 150px; height: 80px; object-fit: cover; border-radius: 8px; margin-bottom: 8px; border: 2px solid #cd853f; }
        .weapon-result .weapon-name { font-size: 1em; color: #cd853f; margin-bottom: 5px; }
        .weapon-result .weapon-desc { font-size: 0.7em; color: #d4a574; margin-bottom: 8px; }
        .weapon-result .weapon-stats { display: flex; justify-content: center; gap: 10px; }
        .weapon-result .stat { background: rgba(205, 133, 63, 0.2); padding: 4px 10px; border-radius: 12px; font-size: 0.8em; }

        /* ===== BUTTONS ===== */
        .btn {
            background: linear-gradient(180deg, #cd853f 0%, #8b4513 100%);
            border: 3px solid #5c3310; color: #f4e4bc;
            padding: 10px 20px; font-size: 1em; font-family: 'Georgia', serif;
            font-weight: bold; cursor: pointer; border-radius: 8px;
            transition: all 0.3s ease; box-shadow: 3px 3px 0 rgba(0,0,0,0.3);
        }
        .btn:hover { background: linear-gradient(180deg, #d4a574 0%, #a0522d 100%); transform: translateY(-2px); }
        .btn:disabled { opacity: 0.5; cursor: not-allowed; transform: none; }
        .btn-success { background: linear-gradient(180deg, #4ade80 0%, #22c55e 100%); border-color: #166534; }
        .btn-danger { background: linear-gradient(180deg, #f87171 0%, #ef4444 100%); border-color: #991b1b; }

        /* ===== POPUP ===== */
        .popup-overlay {
            display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(44, 24, 16, 0.85); z-index: 2000;
            align-items: center; justify-content: center;
            animation: overlayFade 0.3s ease;
        }
        .popup-overlay.active { display: flex; }
        @keyframes overlayFade { from { opacity: 0; } to { opacity: 1; } }
        .popup {
            background: linear-gradient(135deg, #f9edd3 0%, #f4e4bc 50%, #e8d5b5 100%);
            border: 5px solid #8b4513; border-radius: 20px;
            padding: 20px; max-width: 95vw; max-height: 90vh;
            overflow-y: auto; animation: popupSlide 0.3s ease;
            box-shadow: 0 10px 40px rgba(0,0,0,0.5);
        }
        @keyframes popupSlide { from { transform: scale(0.8) translateY(-50px); opacity: 0; } to { transform: scale(1) translateY(0); opacity: 1; } }
        .popup-header { display: flex; justify-content: space-between; align-items: center; border-bottom: 2px dashed #c9a66b; padding-bottom: 10px; margin-bottom: 15px; }
        .popup-title { font-size: 1.4em; color: #8b4513; text-shadow: 1px 1px 0 rgba(255,255,255,0.5); }
        .popup-close {
            background: linear-gradient(180deg, #f87171 0%, #ef4444 100%);
            border: 2px solid #991b1b; color: #fff;
            width: 35px; height: 35px; border-radius: 50%;
            font-size: 1.2em; cursor: pointer; display: flex;
            align-items: center; justify-content: center;
        }
        .popup-close:hover { transform: scale(1.1); }
        .card-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(95px, 1fr)); gap: 10px; max-height: 60vh; overflow-y: auto; padding: 5px; }

        /* ===== INFO BADGE ===== */
        .info-badge { font-size: 0.6em; padding: 2px 6px; border-radius: 10px; margin-left: 5px; }
        .badge-free { background: #22c55e; color: #fff; }
        .badge-paid { background: #f59e0b; color: #fff; }

        /* ===== RECIPE TABLE ===== */
        .recipe-table { width: 100%; border-collapse: collapse; font-size: 0.8em; margin-top: 10px; }
        .recipe-table th, .recipe-table td { border: 1px solid #8b4513; padding: 6px; text-align: center; }
        .recipe-table th { background: rgba(139, 69, 19, 0.2); color: #5c3310; }
        .recipe-table td { background: rgba(255,255,255,0.5); }
        .recipe-table .empty { background: rgba(0,0,0,0.1); color: #999; }

        /* ===== GRID ===== */
        .grid-2 { display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; }
        .grid-3 { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; }
        .grid-4 { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; }
        @media (max-width: 768px) {
            .grid-2, .grid-3, .grid-4 { grid-template-columns: repeat(2, 1fr); }
            .crafting-area { flex-direction: column; }
            .plus-sign, .equals-sign { transform: rotate(90deg); }
        }

        .text-center { text-align: center; }
        .mt-15 { margin-top: 15px; }
        .hidden { display: none !important; }

        /* ===== FOOTER ===== */
        .footer {
            background: linear-gradient(180deg, #5c3310 0%, #3d2817 100%);
            padding: 15px; text-align: center; color: #d4a574;
            margin-top: 20px; border-top: 5px solid #8b4513;
        }
        .footer .stats { display: flex; justify-content: center; gap: 15px; margin-top: 8px; font-size: 0.85em; flex-wrap: wrap; }
    </style>
</head>
<body>
    <div class="paper-texture"></div>

    <!-- HEADER -->
    <header class="header">
        <h1>üè† Guerra de Quintal</h1>
        <div class="subtitle">Mestres da Sucata</div>
    </header>

    <!-- NAVIGATION -->
    <nav class="nav">
        <button class="nav-btn active" onclick="showSection('crafting')">üîß Crafting</button>
        <button class="nav-btn" onclick="showSection('recipes')">üìñ Receitas</button>
        <button class="nav-btn" onclick="showSection('rules')">üìú Regras</button>
    </nav>

    <!-- MAIN CONTENT -->
    <main class="main">
        
        <!-- CRAFTING SECTION -->
        <section id="crafting" class="section active">
            <div class="card">
                <h2 class="card-title">üîß Oficina de Crafting</h2>
                <p class="text-center" style="color: #5c3310; font-size: 0.9em; margin-bottom: 15px;">
                    Combine os itens para criar armas e armadilhas! Clique nos slots para selecionar.
                </p>

                <!-- Crafting Area -->
                <div class="crafting-area">
                    <div class="craft-slot" id="slot-essential" onclick="openCardPicker('essential')">
                        <div class="slot-emoji">‚ùì</div>
                        <div class="slot-label">Item Essencial</div>
                        <div class="slot-type">Cora√ß√£o</div>
                    </div>
                    <span class="plus-sign">+</span>
                    <div class="craft-slot" id="slot-base" onclick="openCardPicker('base')">
                        <div class="slot-emoji">‚ùì</div>
                        <div class="slot-label">Base</div>
                        <div class="slot-type">Suporte</div>
                    </div>
                    <span class="plus-sign">+</span>
                    <div class="craft-slot" id="slot-basic-free" onclick="openCardPicker('basicFree')">
                        <div class="slot-emoji">‚ùì</div>
                        <div class="slot-label">B√°sico Gr√°tis</div>
                        <div class="slot-type">üÜì Gratuito</div>
                    </div>
                    <span class="plus-sign">+</span>
                    <div class="craft-slot" id="slot-basic-paid" onclick="openCardPicker('basicPaid')">
                        <div class="slot-emoji">‚ùì</div>
                        <div class="slot-label">B√°sico 1üí∞</div>
                        <div class="slot-type">1 Moeda</div>
                    </div>
                    <span class="plus-sign">+</span>
                    <div class="craft-slot" id="slot-trigger" onclick="openCardPicker('trigger')">
                        <div class="slot-emoji">‚ùì</div>
                        <div class="slot-label">Acionador</div>
                        <div class="slot-type">Gatilho</div>
                    </div>
                    <span class="plus-sign">+</span>
                    <div class="craft-slot" id="slot-ammo" onclick="openCardPicker('ammo')">
                        <div class="slot-emoji">‚ùì</div>
                        <div class="slot-label">Muni√ß√£o</div>
                        <div class="slot-type">Carga</div>
                    </div>
                    <span class="equals-sign">=</span>
                    <div class="result-slot" id="result-slot">
                        <div class="slot-emoji">üéÅ</div>
                        <div class="slot-label">Resultado</div>
                    </div>
                </div>

                <!-- Buttons -->
                <div class="text-center mt-15">
                    <button class="btn btn-success" id="craft-btn" onclick="craft()" disabled>üî® Criar Arma!</button>
                    <button class="btn" onclick="resetCrafting()" style="margin-left: 10px;">üîÑ Limpar</button>
                </div>
            </div>

            <!-- Instructions -->
            <div class="card">
                <h3 class="card-title">üìã Como Funciona</h3>
                <div style="line-height: 1.8; color: #5c3310; font-size: 0.9em;">
                    <p><strong>6 Componentes para criar uma arma:</strong></p>
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li><strong>‚ù§Ô∏è Item Essencial (Cora√ß√£o):</strong> O componente principal da arma</li>
                        <li><strong>üì¶ Base (Suporte):</strong> Estrutura de suporte</li>
                        <li><strong>üÜì B√°sico Gratuito:</strong> Material b√°sico sem custo</li>
                        <li><strong>üí∞ B√°sico 1 Moeda:</strong> Material que custa 1 moeda</li>
                        <li><strong>‚ö° Acionador (Gatilho):</strong> Mecanismo de ativa√ß√£o</li>
                        <li><strong>üéØ Muni√ß√£o (Carga):</strong> Proj√©til ou carga da arma</li>
                    </ul>
                    <p style="margin-top: 10px; font-style: italic; color: #8b4513;">
                        üí° Alguns componentes podem ficar vazios (‚àí) dependendo da receita!
                    </p>
                </div>
            </div>
        </section>

        <!-- RECIPES SECTION -->
        <section id="recipes" class="section">
            <div class="card">
                <h2 class="card-title">üìñ Livro de Receitas</h2>
                <p class="text-center" style="color: #5c3310; margin-bottom: 15px;">
                    Todas as 21 armas e armadilhas dispon√≠veis
                </p>
                <div style="overflow-x: auto;">
                    <table class="recipe-table" id="recipe-table"></table>
                </div>
            </div>
        </section>

        <!-- RULES SECTION -->
        <section id="rules" class="section">
            <div class="card">
                <h2 class="card-title">üìú Regras do Jogo</h2>
                <div style="line-height: 1.8; color: #5c3310; padding: 10px;">
                    <h3 style="color: #8b4513; margin: 15px 0 10px;">üîß Sistema de Crafting</h3>
                    <ul style="margin-left: 20px;">
                        <li>Combine 6 tipos de componentes para criar armas</li>
                        <li>Alguns slots podem ficar vazios (‚àí) em certas receitas</li>
                        <li>Cada arma tem poder de fogo e elemento diferentes</li>
                    </ul>

                    <h3 style="color: #8b4513; margin: 15px 0 10px;">‚öîÔ∏è Sistema de Combate</h3>
                    <ul style="margin-left: 20px;">
                        <li>Role dados d6 igual ao poder de fogo da arma</li>
                        <li><strong>4, 5, 6</strong> = Acerto (causa 1 de dano)</li>
                        <li><strong>1, 2, 3</strong> = Erro</li>
                        <li><strong>Fraqueza elemental:</strong> +1 dado extra</li>
                        <li><strong>Resist√™ncia elemental:</strong> -1 sucesso</li>
                    </ul>

                    <h3 style="color: #8b4513; margin: 15px 0 10px;">üëπ Monstros do Folclore</h3>
                    <ul style="margin-left: 20px;">
                        <li><strong>üåÄ Saci:</strong> HP 3 - Fraqueza: Terra - Resist√™ncia: F√≠sico</li>
                        <li><strong>üê¥ Mula Sem Cabe√ßa:</strong> HP 5 - Fraqueza: √Ågua - Resist√™ncia: Fogo</li>
                        <li><strong>üêï Capelobo:</strong> HP 4 - Fraqueza: El√©trico - Resist√™ncia: F√≠sico</li>
                        <li><strong>üå≤ Curupira:</strong> HP 3 - Fraqueza: F√≠sico - Resist√™ncia: El√©trico</li>
                        <li><strong>üî• Boitat√°:</strong> HP 4 - Fraqueza: Gelo - Resist√™ncia: Fogo</li>
                        <li><strong>üßô‚Äç‚ôÄÔ∏è Cuca (Boss):</strong> HP 10 - Fraqueza: Dano Combinado</li>
                    </ul>
                </div>
            </div>
        </section>

    </main>

    <!-- POPUP FOR CARD PICKER -->
    <div class="popup-overlay" id="card-picker-popup">
        <div class="popup" style="width: 650px;">
            <div class="popup-header">
                <h3 class="popup-title" id="picker-title">Escolha uma Carta</h3>
                <button class="popup-close" onclick="closePopup()">√ó</button>
            </div>
            <div class="card-grid" id="picker-cards"></div>
        </div>
    </div>

    <!-- FOOTER -->
    <footer class="footer">
        <p>üé≤ Guerra de Quintal: Mestres da Sucata</p>
        <div class="stats">
            <span>üîß 21 Armas</span>
            <span>‚Ä¢</span>
            <span>üì¶ 6 Tipos de Componentes</span>
            <span>‚Ä¢</span>
            <span>üëπ 6 Monstros</span>
        </div>
    </footer>

    <script>
        // ===== GAME DATA FROM SPREADSHEET =====
        const ELEMENTS = {
            physical: { name: 'F√≠sico', emoji: '‚öîÔ∏è', color: '#8B4513' },
            fire: { name: 'Fogo', emoji: 'üî•', color: '#FF4500' },
            water: { name: '√Ågua', emoji: 'üíß', color: '#1E90FF' },
            electric: { name: 'El√©trico', emoji: '‚ö°', color: '#FFD700' },
            ice: { name: 'Gelo', emoji: '‚ùÑÔ∏è', color: '#87CEEB' },
            earth: { name: 'Terra', emoji: 'üåç', color: '#8B4513' },
            sound: { name: 'Som', emoji: 'üì¢', color: '#9370DB' }
        };

        // ALL WEAPONS FROM SPREADSHEET
        const WEAPONS = [
            { id: 'w1', name: 'Sentinela Nerf', element: 'physical', firepower: 3,
              essential: 'Pistola Nerf', base: 'Base de Ventilador', basicFree: 'Fita adesiva', basicPaid: 'Fios', trigger: 'Sensor de Movimento', ammo: 'Dardos Nerf' },
            { id: 'w2', name: 'Metralhadora Vulcan', element: 'physical', firepower: 5,
              essential: 'Nerf Vulcan', base: 'Base de Ventilador', basicFree: 'Fita adesiva', basicPaid: 'Fios', trigger: 'Sensor de Movimento', ammo: 'Dardos Nerf' },
            { id: 'w3', name: 'Sentinela de Fogo', element: 'fire', firepower: 4,
              essential: 'Super Soaker', base: 'Trip√© de C√¢mera', basicFree: 'Fita adesiva', basicPaid: 'Fios', trigger: 'Sensor de Movimento', ammo: 'Querosene' },
            { id: 'w4', name: 'Canh√£o de T√™nis', element: 'physical', firepower: 3,
              essential: 'Soprador de Folhas', base: 'Carrinho de M√£o', basicFree: 'Fita adesiva', basicPaid: 'Tubo de PVC', trigger: 'Fio de Trope√ßo', ammo: 'T√™nis Velho' },
            { id: 'w5', name: 'Mina de Goma', element: 'earth', firepower: 2,
              essential: 'Ratoeira', base: 'Caixa de Papel√£o', basicFree: '-', basicPaid: '-', trigger: 'Fio de Trope√ßo', ammo: 'Goma' },
            { id: 'w6', name: 'Lan√ßador de Geleca', element: 'earth', firepower: 2,
              essential: 'P√° de Jardim', base: 'Estacas de Madeira', basicFree: 'El√°sticos', basicPaid: 'Barbante', trigger: 'Fio de Trope√ßo', ammo: 'Bal√µes' },
            { id: 'w7', name: 'Armadilha de Gude', element: 'earth', firepower: 1,
              essential: 'Pote de Vidro', base: 'Estacas de Madeira', basicFree: '-', basicPaid: 'Barbante', trigger: 'Fio de Trope√ßo', ammo: 'Bolas de Gude' },
            { id: 'w8', name: 'Morteiro de √Ågua', element: 'water', firepower: 3,
              essential: '-', base: 'Estacas de Madeira', basicFree: 'El√°sticos', basicPaid: 'Tubo de PVC', trigger: 'Interruptor', ammo: 'Bal√µes' },
            { id: 'w9', name: 'Armadilha Espanador', element: 'physical', firepower: 1,
              essential: 'Espanador de P√≥', base: 'Estacas de Madeira', basicFree: 'Madeirite', basicPaid: 'Barbante', trigger: 'Fio de Trope√ßo', ammo: '-' },
            { id: 'w10', name: 'Teia de Aranha', element: 'earth', firepower: 2,
              essential: '-', base: 'Estacas de Madeira', basicFree: '-', basicPaid: 'Barbante', trigger: 'Fio de Trope√ßo', ammo: 'Pregos' },
            { id: 'w11', name: 'Cobra de Mangueira', element: 'water', firepower: 2,
              essential: 'Mangueira Furada', base: '-', basicFree: 'Madeirite', basicPaid: 'Fios', trigger: 'Interruptor', ammo: '√Ågua' },
            { id: 'w12', name: 'Spray de Pimenta', element: 'fire', firepower: 3,
              essential: 'Pulverizador', base: '-', basicFree: '-', basicPaid: 'Barbante', trigger: 'Fio de Trope√ßo', ammo: 'Molho de Pimenta' },
            { id: 'w13', name: 'Espantalho', element: 'physical', firepower: 1,
              essential: 'Roupas Velhas', base: '-', basicFree: 'Madeirite', basicPaid: 'Barbante', trigger: '-', ammo: 'Bal√µes' },
            { id: 'w14', name: 'Bambol√™ de Fogo', element: 'fire', firepower: 4,
              essential: 'Bambol√™', base: '-', basicFree: 'Madeirite', basicPaid: 'Barbante', trigger: 'Fio de Trope√ßo', ammo: 'Querosene' },
            { id: 'w15', name: 'Tapete de Brasas', element: 'fire', firepower: 3,
              essential: 'Tapete Velho', base: 'Chapa de Metal', basicFree: '-', basicPaid: 'Fios', trigger: 'Fio de Trope√ßo', ammo: 'Querosene' },
            { id: 'w16', name: 'Aspersor de Lama', element: 'earth', firepower: 2,
              essential: 'Aspersor Oscilante', base: 'Balde', basicFree: '-', basicPaid: 'Tubo de PVC', trigger: 'Interruptor', ammo: '√Ågua' },
            { id: 'w17', name: 'P√™ndulo de Pneu', element: 'physical', firepower: 4,
              essential: 'Pneu de Carro', base: '-', basicFree: 'Madeirite', basicPaid: 'Barbante', trigger: 'Fio de Trope√ßo', ammo: 'Pregos' },
            { id: 'w18', name: 'Gravidade de Fogo', element: 'fire', firepower: 3,
              essential: '-', base: 'Tijolo', basicFree: '-', basicPaid: 'Barbante', trigger: 'Fio de Trope√ßo', ammo: 'Lata de Spray' },
            { id: 'w19', name: 'Besta de L√°pis', element: 'physical', firepower: 3,
              essential: 'Motor El√©trico', base: 'Caixote de Madeira', basicFree: '-', basicPaid: 'Fios', trigger: 'Interruptor', ammo: 'L√°pis de Cor' },
            { id: 'w20', name: 'Lan√ßador de T√™nis', element: 'physical', firepower: 3,
              essential: 'Roda de Bicicleta', base: '-', basicFree: 'Madeirite', basicPaid: 'Tubo de PVC', trigger: 'Sensor de Movimento', ammo: 'Bolas de T√™nis' },
            { id: 'w21', name: 'Armadilha Choque', element: 'electric', firepower: 4,
              essential: 'Bateria de Carro', base: '-', basicFree: '-', basicPaid: 'Fios', trigger: '-', ammo: '-' }
        ];

        // CARD DECKS
        const CARDS = {
            essential: [
                { id: 'e1', name: 'Pistola Nerf', emoji: 'üî´', img: 'craft/arma_nerf_sentinela.webp' },
                { id: 'e2', name: 'Nerf Vulcan', emoji: 'üî´', img: 'craft/arma_vulcan.webp' },
                { id: 'e3', name: 'Super Soaker', emoji: 'üíß', img: 'craft/arma_spray.webp' },
                { id: 'e4', name: 'Soprador de Folhas', emoji: 'üå¨Ô∏è', img: 'craft/craft_01.webp' },
                { id: 'e5', name: 'Ratoeira', emoji: 'ü™§', img: 'craft/arma_mina.webp' },
                { id: 'e6', name: 'P√° de Jardim', emoji: 'üî®', img: 'craft/craft_02.webp' },
                { id: 'e7', name: 'Pote de Vidro', emoji: 'üè∫', img: 'craft/craft_03.webp' },
                { id: 'e8', name: 'Espanador de P√≥', emoji: 'ü™∂', img: 'craft/arma_teia.webp' },
                { id: 'e9', name: 'Mangueira Furada', emoji: 'üêç', img: 'craft/arma_spray.webp' },
                { id: 'e10', name: 'Pulverizador', emoji: 'üí¶', img: 'craft/arma_spray.webp' },
                { id: 'e11', name: 'Roupas Velhas', emoji: 'üëï', img: 'craft/craft_04.webp' },
                { id: 'e12', name: 'Bambol√™', emoji: '‚≠ï', img: 'craft/craft_05.webp' },
                { id: 'e13', name: 'Tapete Velho', emoji: 'üü´', img: 'craft/craft_06.webp' },
                { id: 'e14', name: 'Aspersor Oscilante', emoji: 'üåßÔ∏è', img: 'craft/arma_spray.webp' },
                { id: 'e15', name: 'Pneu de Carro', emoji: '‚≠ï', img: 'craft/arma_pendulo.webp' },
                { id: 'e16', name: 'Motor El√©trico', emoji: '‚öôÔ∏è', img: 'craft/arma_choque.webp' },
                { id: 'e17', name: 'Roda de Bicicleta', emoji: 'üö≤', img: 'craft/arma_canhao.webp' },
                { id: 'e18', name: 'Bateria de Carro', emoji: 'üîã', img: 'craft/arma_choque.webp' }
            ],
            base: [
                { id: 'b1', name: 'Base de Ventilador', emoji: 'üåÄ', img: 'craft/craft_07.webp' },
                { id: 'b2', name: 'Trip√© de C√¢mera', emoji: 'üì∑', img: 'craft/craft_08.webp' },
                { id: 'b3', name: 'Carrinho de M√£o', emoji: 'üõí', img: 'craft/craft_09.webp' },
                { id: 'b4', name: 'Caixa de Papel√£o', emoji: 'üì¶', img: 'craft/craft_10.webp' },
                { id: 'b5', name: 'Estacas de Madeira', emoji: 'ü™µ', img: 'craft/arma_teia.webp' },
                { id: 'b6', name: 'Chapa de Metal', emoji: 'üî©', img: 'craft/craft_11.webp' },
                { id: 'b7', name: 'Balde', emoji: 'ü™£', img: 'craft/craft_12.webp' },
                { id: 'b8', name: 'Tijolo', emoji: 'üß±', img: 'craft/craft_13.webp' },
                { id: 'b9', name: 'Caixote de Madeira', emoji: 'üì¶', img: 'craft/craft_14.webp' }
            ],
            basicFree: [
                { id: 'bf1', name: 'Fita Adesiva', emoji: 'ü©π', img: 'craft/craft_15.webp' },
                { id: 'bf2', name: 'El√°sticos', emoji: 'üîó', img: 'craft/craft_16.webp' },
                { id: 'bf3', name: 'Madeirite', emoji: 'ü™µ', img: 'craft/craft_17.webp' }
            ],
            basicPaid: [
                { id: 'bp1', name: 'Fios', emoji: 'üîå', img: 'craft/arma_choque.webp' },
                { id: 'bp2', name: 'Tubo de PVC', emoji: 'üîß', img: 'craft/arma_canhao.webp' },
                { id: 'bp3', name: 'Barbante', emoji: 'üßµ', img: 'craft/arma_teia.webp' }
            ],
            trigger: [
                { id: 't1', name: 'Sensor de Movimento', emoji: 'üì°', img: 'craft/craft_18.webp' },
                { id: 't2', name: 'Fio de Trope√ßo', emoji: 'üßµ', img: 'craft/arma_teia.webp' },
                { id: 't3', name: 'Interruptor', emoji: 'üîò', img: 'craft/arma_choque.webp' }
            ],
            ammo: [
                { id: 'a1', name: 'Dardos Nerf', emoji: 'üéØ', img: 'craft/arma_nerf_sentinela.webp' },
                { id: 'a2', name: 'Querosene', emoji: 'üî•', img: 'craft/arma_fogo.webp' },
                { id: 'a3', name: 'T√™nis Velho', emoji: 'üëü', img: 'craft/arma_canhao.webp' },
                { id: 'a4', name: 'Goma', emoji: 'üç¨', img: 'craft/arma_mina.webp' },
                { id: 'a5', name: 'Bal√µes', emoji: 'üéà', img: 'craft/craft_19.webp' },
                { id: 'a6', name: 'Bolas de Gude', emoji: '‚ö™', img: 'craft/craft_20.webp' },
                { id: 'a7', name: 'Pregos', emoji: 'üìå', img: 'craft/arma_teia.webp' },
                { id: 'a8', name: '√Ågua', emoji: 'üíß', img: 'craft/arma_spray.webp' },
                { id: 'a9', name: 'Molho de Pimenta', emoji: 'üå∂Ô∏è', img: 'craft/arma_spray.webp' },
                { id: 'a10', name: 'L√°pis de Cor', emoji: '‚úèÔ∏è', img: 'craft/craft_01.webp' },
                { id: 'a11', name: 'Bolas de T√™nis', emoji: 'üéæ', img: 'craft/arma_canhao.webp' },
                { id: 'a12', name: 'Lata de Spray', emoji: 'üß¥', img: 'craft/arma_spray.webp' }
            ]
        };

        // STATE
        let currentSection = 'crafting';
        let craftingSlots = { essential: null, base: null, basicFree: null, basicPaid: null, trigger: null, ammo: null };
        let currentPickerType = null;

        // ===== NAVIGATION =====
        function showSection(section) {
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
            document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
            document.getElementById(section).classList.add('active');
            event.target.classList.add('active');
            currentSection = section;
            if (section === 'recipes') renderRecipeTable();
        }

        // ===== POPUP =====
        function openCardPicker(type) {
            currentPickerType = type;
            const cards = CARDS[type];
            const typeNames = {
                essential: 'Item Essencial',
                base: 'Base (Suporte)',
                basicFree: 'B√°sico Gratuito',
                basicPaid: 'B√°sico (1 Moeda)',
                trigger: 'Acionador (Gatilho)',
                ammo: 'Muni√ß√£o (Carga)'
            };
            document.getElementById('picker-title').textContent = `Escolha: ${typeNames[type]}`;

            const cardsHtml = cards.map(card => `
                <div class="craft-card ${craftingSlots[type]?.id === card.id ? 'selected' : ''}"
                     onclick="selectCard('${type}', '${card.id}', '${card.name}', '${card.emoji}', '${card.img}')">
                    <img class="card-image" src="${card.img}" alt="${card.name}" onerror="this.style.display='none'">
                    <div class="card-emoji">${card.emoji}</div>
                    <div class="card-name">${card.name}</div>
                    ${type === 'basicFree' ? '<span class="info-badge badge-free">GR√ÅTIS</span>' : ''}
                    ${type === 'basicPaid' ? '<span class="info-badge badge-paid">1üí∞</span>' : ''}
                </div>
            `).join('');

            document.getElementById('picker-cards').innerHTML = cardsHtml;
            document.getElementById('card-picker-popup').classList.add('active');
        }

        function closePopup() {
            document.getElementById('card-picker-popup').classList.remove('active');
        }

        function selectCard(type, id, name, emoji, img) {
            craftingSlots[type] = { id, name, emoji, img };
            const slot = document.getElementById(`slot-${type}`);
            slot.innerHTML = `
                <img class="slot-image" src="${img}" alt="${name}" onerror="this.outerHTML='<div class=\\'slot-emoji\\'>${emoji}</div>'">
                <div class="slot-label">${name}</div>
                <div class="slot-type">${type === 'basicFree' ? 'üÜì Gratuito' : type === 'basicPaid' ? '1üí∞ Moeda' : ''}</div>
            `;
            slot.classList.add('filled');
            closePopup();
            checkCraftingComplete();
        }

        function checkCraftingComplete() {
            // Check if at least essential is filled (some recipes have empty slots)
            const hasEssential = craftingSlots.essential !== null;
            document.getElementById('craft-btn').disabled = !hasEssential;
        }

        function craft() {
            // Find matching weapon
            let matchedWeapon = null;
            
            for (const weapon of WEAPONS) {
                const matches = 
                    checkSlot(weapon.essential, craftingSlots.essential) &&
                    checkSlot(weapon.base, craftingSlots.base) &&
                    checkSlot(weapon.basicFree, craftingSlots.basicFree) &&
                    checkSlot(weapon.basicPaid, craftingSlots.basicPaid) &&
                    checkSlot(weapon.trigger, craftingSlots.trigger) &&
                    checkSlot(weapon.ammo, craftingSlots.ammo);
                
                if (matches) {
                    matchedWeapon = weapon;
                    break;
                }
            }

            const resultSlot = document.getElementById('result-slot');
            
            if (matchedWeapon) {
                const elem = ELEMENTS[matchedWeapon.element];
                resultSlot.innerHTML = `
                    <div class="weapon-result">
                        <div class="weapon-name">${elem.emoji} ${matchedWeapon.name}</div>
                        <div class="weapon-desc">Arma criada com sucesso!</div>
                        <div class="weapon-stats">
                            <div class="stat">‚öîÔ∏è ${matchedWeapon.firepower}d</div>
                            <div class="stat">${elem.emoji} ${elem.name}</div>
                        </div>
                    </div>
                `;
                resultSlot.classList.add('filled');
            } else {
                resultSlot.innerHTML = `
                    <div class="slot-emoji">‚ùå</div>
                    <div class="slot-label" style="color: #ef4444;">Combina√ß√£o Inv√°lida</div>
                `;
                resultSlot.classList.remove('filled');
            }
        }

        function checkSlot(required, selected) {
            if (required === '-') return selected === null || selected.name === '-';
            if (!selected) return false;
            return selected.name === required;
        }

        function resetCrafting() {
            craftingSlots = { essential: null, base: null, basicFree: null, basicPaid: null, trigger: null, ammo: null };
            const slotTypes = ['essential', 'base', 'basicFree', 'basicPaid', 'trigger', 'ammo'];
            const slotLabels = ['Item Essencial', 'Base', 'B√°sico Gr√°tis', 'B√°sico 1üí∞', 'Acionador', 'Muni√ß√£o'];
            const slotTypeLabels = ['Cora√ß√£o', 'Suporte', 'üÜì Gratuito', '1 Moeda', 'Gatilho', 'Carga'];
            
            slotTypes.forEach((type, i) => {
                const slot = document.getElementById(`slot-${type}`);
                slot.innerHTML = `
                    <div class="slot-emoji">‚ùì</div>
                    <div class="slot-label">${slotLabels[i]}</div>
                    <div class="slot-type">${slotTypeLabels[i]}</div>
                `;
                slot.classList.remove('filled');
            });

            const resultSlot = document.getElementById('result-slot');
            resultSlot.innerHTML = `
                <div class="slot-emoji">üéÅ</div>
                <div class="slot-label">Resultado</div>
            `;
            resultSlot.classList.remove('filled');
            document.getElementById('craft-btn').disabled = true;
        }

        // ===== RECIPE TABLE =====
        function renderRecipeTable() {
            const headers = ['Arma', '‚ù§Ô∏è Essencial', 'üì¶ Base', 'üÜì B√°sico Gr√°tis', 'üí∞ B√°sico 1$', '‚ö° Gatilho', 'üéØ Muni√ß√£o'];
            let html = '<thead><tr>' + headers.map(h => `<th>${h}</th>`).join('') + '</tr></thead><tbody>';
            
            WEAPONS.forEach(w => {
                const elem = ELEMENTS[w.element];
                html += `<tr>
                    <td><strong>${elem.emoji} ${w.name}</strong><br><small>‚öîÔ∏è${w.firepower}d</small></td>
                    <td>${w.essential || '<span class="empty">‚àí</span>'}</td>
                    <td>${w.base || '<span class="empty">‚àí</span>'}</td>
                    <td>${w.basicFree || '<span class="empty">‚àí</span>'}</td>
                    <td>${w.basicPaid || '<span class="empty">‚àí</span>'}</td>
                    <td>${w.trigger || '<span class="empty">‚àí</span>'}</td>
                    <td>${w.ammo || '<span class="empty">‚àí</span>'}</td>
                </tr>`;
            });
            
            html += '</tbody>';
            document.getElementById('recipe-table').innerHTML = html;
        }

        // ===== INIT =====
        document.addEventListener('DOMContentLoaded', () => {
            renderRecipeTable();
        });

        // Close popup on outside click
        document.getElementById('card-picker-popup').addEventListener('click', function(e) {
            if (e.target === this) closePopup();
        });
    </script>
</body>
</html>
